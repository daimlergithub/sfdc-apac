<!--  New Create Account VF page added for India and Turkey. -->
<apex:page standardController="Account" extensions="AddressSearchValidationControllerCDM" lightningStylesheets="true" > 
    <apex:pageMessages id="msgs" escape="false"/>
    <apex:form id="form">
            <apex:pageBlock mode="edit" title="{!$Label.New_Account_Information}"  >
        <!--  Record Type Selection - Start -->
                <!--Add condition for respective market to show this block here-->
                <apex:pageBlockSection rendered="{!If(ISPICKVAL($User.Market__c,'IN') ,true,false)}">
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.Account.fields.RecordTypeId.Label}"/>
                        <apex:outputPanel styleClass="requiredInput" layout="block">
                         <apex:outputPanel styleClass="requiredBlock" layout="block"/>
                            <apex:selectList id="selectRecType" value="{!RecordType}" size="1" required="true" >
                                <apex:selectOption itemValue="Select" itemLabel="--Select--" />
                                <apex:selectOption itemValue="Person Account" itemLabel="Person Account"/>
                                <apex:selectOption itemValue="Company" itemLabel="Company"/>
                            	<!--Add condition for rerendering section based on change of record type -->
                                <apex:actionSupport event="onchange" reRender="personAccountPanelIN,companyAccountPanelIN,addressIN,buttonIN,mergeWarning"/>
                            </apex:selectList>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>          
        <!--  Record Type Selection - End -->   
        <!--  India MARKET Person Account - Start -->        
                <apex:outputPanel id="personAccountPanelIN">
                <apex:pageBlockSection id="PersonAccBlockIN" title="{!$Label.Person_Account_Information}" rendered="{!If( AND(RecordType == 'Person Account',$Permission.INGeneric) ,true,false)}">
                    <apex:pageBlockSectionItem >                        
                        <apex:outputLabel value="{!$ObjectType.Account.fields.FirstName.Label}"/>       
                        <apex:outputPanel styleClass="requiredInput" layout="block">        
                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>       
                            <apex:inputText value="{!objAccount.FirstName}" />       
                        </apex:outputPanel>        
                    </apex:pageBlockSectionItem>  
                    <apex:pageBlockSectionItem >        
                        <apex:outputLabel value="{!$ObjectType.Account.fields.LastName.Label}"/>        
                        <apex:outputPanel styleClass="requiredInput" layout="block">        
                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>       
                            <apex:inputText value="{!objAccount.LastName}" />       
                        </apex:outputPanel>     
                    </apex:pageBlockSectionItem>                    
                    <apex:pageBlockSectionItem >        
                        <apex:outputLabel value="{!$ObjectType.Account.fields.Individual_Home_Phone__c.Label}" />       
                        <apex:outputPanel >  
                          <apex:inputText value="{!hmCountryCode}" id="hmCountryCodeLtng" style="width:30px;min-width:4rem" rendered="{!!isClassic}"> 
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="PersonAccBlockIN,hmAreaCode" >
                            </apex:actionSupport>
                          </apex:inputText>
                          <apex:inputText value="{!hmCountryCode}" id="hmCountryCode" maxlength="5" style="width:30px" rendered="{!isClassic}" > 
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="PersonAccBlockIN,hmAreaCode" >
                            </apex:actionSupport>
                          </apex:inputText>
                          <apex:inputText value="{!hmAreaCode}" id="hmAreaCode" maxlength="5" style="width:80px" rendered="{!If( AND(hAreaBoolean == false,isClassic == true) ,true,false)}"/>  
                          <apex:inputText value="{!hmAreaCode}" id="hmAreaCodeLtng" style="width:80px;min-width:4rem" rendered="{!If( AND(hAreaBoolean == false,isClassic == false) ,true,false)}"/>                                      
                          <apex:inputText value="{!hmphoneNumber}" id="hmphoneNumber" style="width:120px" rendered="{!isClassic}"/> 
                          <apex:inputText value="{!hmphoneNumber}" id="hmphoneNumberLtng" style="width:120px;min-width:10rem" rendered="{!!isClassic}"/>                                      
                        </apex:outputPanel>     
                    </apex:pageBlockSectionItem>        
                   <apex:pageBlockSectionItem >     
                        <apex:outputLabel value="{!$ObjectType.Account.fields.Mobile__c.Label}" />      
                        <apex:outputPanel >     
                          <apex:inputText value="{!mbCountryCode}" id="mbCountryCode" maxLength="5" style="width:30px" rendered="{!isClassic}" />
                          <apex:inputText value="{!mbCountryCode}" id="mbCountryCodeLtng" style="width:30px;min-width:5rem;" rendered="{!!isClassic}"/> 
                          <apex:inputText value="{!mbphoneNumber}" id="mbphoneNumber" style="width:120px" rendered="{!isClassic}"/>
                          <apex:inputText value="{!mbphoneNumber}" id="mbphoneNumberLtng"  style="width:120px;min-width:15rem;" rendered="{!!isClassic}"/>
                        </apex:outputPanel>     
                    </apex:pageBlockSectionItem>                
                    <apex:pageBlockSectionItem >       
                        <apex:outputLabel value="{!$ObjectType.Account.fields.Work_Phone__c.Label}" />      
                        <apex:outputPanel >     
                        <apex:inputText value="{!wkCountryCode}" id="wkCountryCode" maxLength="5" style="width:30px" rendered="{!isClassic}" >
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="PersonAccBlockIN">
                            </apex:actionSupport>
                        </apex:inputText>
                        <apex:inputText value="{!wkCountryCode}" id="wkCountryCodeLtng" style="width:30px;min-width:4rem" rendered="{!!isClassic}" >
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="PersonAccBlockIN">
                            </apex:actionSupport>
                        </apex:inputText>
                        <apex:inputText value="{!wkAreaCode}" id="wkAreaCode" maxLength="5" style="width:80px" rendered="{!If( AND(wAreaBoolean == false,isClassic == true) ,true,false)}"/>                                      
                        <apex:inputText value="{!wkAreaCode}" id="wkAreaCodeLtng" style="width:80px;min-width:4rem" rendered="{!If( AND(wAreaBoolean == false,isClassic == false) ,true,false)}"/> 
                        <apex:inputText value="{!wkphoneNumber}" id="wkphoneNumber" style="width:120px"  rendered="{!isClassic}"/>                                              
                        <apex:inputText value="{!wkphoneNumber}" id="wkphoneNumberLtng" style="width:120px;min-width:10rem"  rendered="{!!isClassic}"/>
                        </apex:outputPanel>                             
                    </apex:pageBlockSectionItem>        
                    <apex:inputField value="{!objAccount.Email__c}" />        
                    <apex:inputField value="{!objAccount.PAN__c}" style="width:160px"/>        
                    <apex:inputField value="{!objAccount.Aadhaar__c}" style="width:160px"/>        
                    <apex:inputField value="{!objAccount.Data_Source__c}" rendered="{!if(Market !='KR',True,false)}" style="width:160px"/>            
                    <apex:inputField value="{!objAccount.Market__c}"/>                             
              </apex:pageBlockSection>      
                </apex:outputPanel>
        <!--  India MARKET Person Account - End -->      

        <!--  India MARKET Company Account - Start -->     
                <apex:outputPanel id="companyAccountPanelIN">
                <apex:pageBlockSection id="companyBlockIN" title="{!$Label.Company_Account_Information}" rendered="{!If( AND(RecordType == 'Company',$Permission.INGeneric) ,true,false)}" >      
                    <apex:pageBlockSectionItem >        
                        <apex:outputLabel value="{!$ObjectType.Account.fields.Name.Label}"/>        
                        <apex:outputPanel styleClass="requiredInput" layout="block">        
                            <apex:outputPanel styleClass="requiredBlock" layout="block"/>       
                            <apex:inputText value="{!objAccount.Name}" />       
                        </apex:outputPanel>     
                    </apex:pageBlockSectionItem>
                    <apex:inputField value="{!objAccount.Corporate_Category__c}" />
                    <apex:inputField value="{!objAccount.Corporate_Group__c}" />
                    <apex:inputField value="{!objAccount.Company_Name__c}"/>               
                    <apex:pageBlockSectionItem >     
                        <apex:outputLabel value="{!$ObjectType.Account.fields.Mobile__c.Label}" />      
                        <apex:outputPanel >     
                          <apex:inputText value="{!mbCountryCode}" id="mbCountryCode" maxLength="5" style="width:30px" rendered="{!isClassic}"/>                                      
                          <apex:inputText value="{!mbCountryCode}" id="mbCountryCodeLtng" style="width:30px;min-width:4rem;" rendered="{!!isClassic}"/>
                          <apex:inputText value="{!mbphoneNumber}" id="mbphoneNumber"  style="width:120px" rendered="{!isClassic}"/>
                          <apex:inputText value="{!mbphoneNumber}" id="mbphoneNumberLtng"  style="width:120px;min-width:15rem;" rendered="{!!isClassic}"/>                             
                        </apex:outputPanel>     
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >        
                        <apex:outputLabel value="{!$ObjectType.Account.fields.Individual_Home_Phone__c.Label}" />       
                        <apex:outputPanel >  
                          <apex:inputText value="{!hmCountryCode}" id="hmCountryCode" maxLength="5" style="width:30px" rendered="{!isClassic}"> 
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="companyBlockIN,hmAreaCode" >
                            </apex:actionSupport>
                          </apex:inputText>
                          <apex:inputText value="{!hmCountryCode}" id="hmCountryCodeLtng" style="width:30px;min-width:4rem"  rendered="{!!isClassic}"> 
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="companyBlockIN,hmAreaCode" >
                            </apex:actionSupport>
                          </apex:inputText>
                          <apex:inputText value="{!hmAreaCode}" id="hmAreaCode" maxLength="5" style="width:80px" rendered="{!If( AND(hAreaBoolean == false,isClassic == true) ,true,false)}"/>
                          <apex:inputText value="{!hmAreaCode}" id="hmAreaCodeLtng" style="width:80px;min-width:4rem" rendered="{!If( AND(hAreaBoolean == false,isClassic == false) ,true,false)}"/>
                          <apex:inputText value="{!hmphoneNumber}" id="hmphoneNumber" style="width:120px" rendered="{!isClassic}"/>                                      
                          <apex:inputText value="{!hmphoneNumber}" id="hmphoneNumberLtng" style="width:120px;min-width:10rem" rendered="{!!isClassic}"/>                                      
                        </apex:outputPanel>     
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >       
                        <apex:outputLabel value="{!$ObjectType.Account.fields.Work_Phone__c.Label}" />      
                        <apex:outputPanel >     
                        <apex:inputText value="{!wkCountryCode}" id="wkCountryCode" maxLength="5" style="width:30px" rendered="{!isClassic}">
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="companyBlockIN">
                            </apex:actionSupport>
                        </apex:inputText>
                        <apex:inputText value="{!wkCountryCode}" id="wkCountryCodeLtng" style="width:30px;min-width:4rem" rendered="{!!isClassic}">
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="companyBlockIN">
                            </apex:actionSupport>
                        </apex:inputText>
                        <apex:inputText value="{!wkAreaCode}" id="wkAreaCode" maxLength="5" style="width:80px" rendered="{!If(AND(wAreaBoolean == false,isClassic == true) ,true,false)}"/>
                        <apex:inputText value="{!wkAreaCode}" id="wkAreaCodeLtng" style="width:80px;min-width:4rem" rendered="{!If(AND(wAreaBoolean == false,isClassic == false) ,true,false)}"/>
                        <apex:inputText value="{!wkphoneNumber}" id="wkphoneNumber" style="width:120px" rendered="{!isClassic}"/>
                        <apex:inputText value="{!wkphoneNumber}" id="wkphoneNumberLtng" style="width:120px;min-width:10rem" rendered="{!!isClassic}"/>   
                        </apex:outputPanel>                             
                    </apex:pageBlockSectionItem>
                     <apex:pageBlockSectionItem >       
                        <apex:outputLabel value="{!$Label.Fax}" />
                        <apex:outputPanel >     
                        <apex:inputText value="{!faxCountryCode}" id="faxCountryCode" maxLength="5" style="width:30px" rendered="{!isClassic}">
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="companyBlockIN">
                            </apex:actionSupport>
                        </apex:inputText>
                        <apex:inputText value="{!faxCountryCode}" id="faxCountryCodeLtng" style="width:30px;min-width:4rem" rendered="{!!isClassic}">
                            <apex:actionSupport action="{!checkcountrycodeindia}" event="onchange" reRender="companyBlockIN">
                            </apex:actionSupport>
                        </apex:inputText>
                        <apex:inputText value="{!faxAreaCode}" id="faxAreaCode" maxLength="5" style="width:80px" rendered="{!If(AND(fAreaBoolean == false,isClassic == true) ,true,false)}"/>
                        <apex:inputText value="{!faxAreaCode}" id="faxAreaCodeLtng" style="width:80px;min-width:4rem" rendered="{!If(AND(fAreaBoolean == false,isClassic == false) ,true,false)}"/>
                        <apex:inputText value="{!faxphoneNumber}" id="faxphoneNumber" style="width:120px" rendered="{!isClassic}"/>
                        <apex:inputText value="{!faxphoneNumber}" id="faxphoneNumberLtng" style="width:120px;min-width:10rem" rendered="{!!isClassic}"/> 
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>        
                   <apex:inputField value="{!objAccount.Email__c}" />       
                   <apex:inputField value="{!objAccount.CIN_Number__c}" />       
                   <apex:inputField value="{!objAccount.GSTN_Number__c}" />       
                   <apex:inputField value="{!objAccount.Data_Source__c}" />       
                   <apex:inputField value="{!objAccount.Market__c}"/>
                </apex:pageBlockSection>            
                </apex:outputPanel>
        <!--  India MARKET Company Account - End -->
        
        <!--  Address Information IN - Start -->        
                <apex:outputPanel id="addressIN">
                <apex:pageBlockSection title="{!$Label.Address_Information}" Id="AddIN" rendered="{!If(AND(OR(RecordType == 'Person Account',RecordType == 'Company'),$Permission.INGeneric) ,true,false)}">      
                    <apex:pageBlockSectionItem >                    
                     <apex:outputLabel value="{!$ObjectType.Address__c.fields.Address_Type__c.Label}"/>     
                        <apex:inputField value="{!AddressObj.Address_Type__c}" style="width:35%; white-space:none;"/>       
                    </apex:pageBlockSectionItem>        
                    <apex:pageBlockSectionItem >        
                        <apex:outputLabel value="{!$ObjectType.Address__c.fields.Address_Line_1__c.Label}"/>        
                        <apex:inputField value="{!AddressObj.Address_Line_1__c}"/>      
                    </apex:pageBlockSectionItem>        
                    <apex:pageBlockSectionItem >        
                        <apex:outputLabel value="{!$ObjectType.Address__c.fields.Address_Line_2__c.Label}"/>        
                        <apex:inputField value="{!AddressObj.Address_Line_2__c}"/>      
                    </apex:pageBlockSectionItem>  
                    <apex:pageBlockSectionItem >        
                        <apex:outputLabel value="{!$ObjectType.Address__c.fields.Address_Line_3__c.Label}"/>        
                        <apex:inputField value="{!AddressObj.Address_Line_3__c}"/>      
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="True">      
                        <apex:outputLabel value="{!$ObjectType.Address__c.fields.Country__c.Label}"/>       
                        <apex:inputField value="{!AddressObj.Country__c}" style="width:35%; white-space:none;"/>        
                    </apex:pageBlockSectionItem>    
                     <apex:pageBlockSectionItem rendered="{!IF(IsForeignNational==false,true,false)}">      
                        <apex:outputLabel value="State/Province"/>      
                         <apex:selectList size="1" value="{!province}" id="slDistrict" >     
                            <apex:selectOptions value="{!lstProvince}"/>                                
                        </apex:selectList>      
                    </apex:pageBlockSectionItem>        
                    <apex:pageBlockSectionItem rendered="{!IF(IsForeignNational==true,true,false)}">        
                        <apex:outputLabel value="State/Province"/>      
                         <apex:inputText id="slStateProvince" value="{!province}"/>     
                    </apex:pageBlockSectionItem>
                     <apex:pageBlockSectionItem >     
                         <apex:outputLabel value="City"/>        
                         <apex:inputText id="inpDistrict" value="{!district}"/>     
                    </apex:pageBlockSectionItem>        
                    <apex:pageBlockSectionItem rendered="{!If( AND(RecordType == 'Person Account',$Permission.INGeneric) ,true,false)}">
                        <apex:outputLabel value="{!$ObjectType.Address__c.fields.Foreign_Nationals__c.Label}"/>
                    <apex:inputField value="{!AddressObj.Foreign_Nationals__c}" id="chkForeignNational">
                        <apex:actionSupport event="onclick" action="{!ShowHideFields}" reRender="addressIN"/>
                    </apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="true">     
                        <apex:outputLabel value="Zip/Postal Code"/>     
                        <apex:inputText id="inpZip" value="{!zip}"/>       
                    </apex:pageBlockSectionItem>        
                    <apex:pageBlockSectionItem >      
                        <apex:outputLabel value="{!$ObjectType.Address__c.fields.Market__c.Label}"/>        
                        <apex:inputField value="{!AddressObj.Market__c}"/>      
                    </apex:pageBlockSectionItem>     
                            
                 <apex:actionFunction name="LoadProvince" action="{!LoadProvince}" reRender="AddrPBSIN">        
                      <apex:param name="provinceSelected" value="" />       
                 </apex:actionFunction>     
                        
                 <apex:actionFunction name="LoadDistrict" action="{!LoadDistrict}" reRender="AddrPBSIN">        
                      <apex:param name="districtselected" value="" />       
                 </apex:actionFunction>                         
                                        
                   <apex:actionFunction name="ShowHideFields" action="{!ShowHideFields}" reRender="AddrPBSIN">          
                      <apex:param name="showhideflds" value="" />       
                 </apex:actionFunction>         
                </apex:pageBlockSection>        
                </apex:outputPanel>
        <!--  Address Information IN - End -->
        <!--  Buttons IN Start -->
                <apex:pageBlockButtons location="bottom">
                    <apex:outputPanel id="buttonIN" >
                        <apex:commandButton action="{!onLineDeduplicationIN}" value="{!$Label.OnLine_Deduplication}" rendered="{!If(AND(OR(RecordType == 'Person Account',RecordType == 'Company'),$Permission.INGeneric) ,true,false)}" reRender="form,msgs,frmCDM" />       
                        <apex:commandButton id="SavebtnIN" action="{!saveAccountIN}" value="{!$Label.Save_Button}" rendered="{!If(AND(OR(RecordType == 'Person Account',RecordType == 'Company'),$Permission.INGeneric,deduplicated==true) ,true,false)}" rerender="msgs"/>     
                        <apex:commandButton action="{!cancel}"  value="{!$Label.Cancel_Button}" rendered="{!If(AND(OR(RecordType == 'Person Account',RecordType == 'Company'),$Permission.INGeneric) ,true,false)}"/>  
                    </apex:outputPanel>    
                </apex:pageBlockButtons>
        <!--  Buttons IN End-->
            </apex:pageBlock>
        <apex:pageBlock title="Match Found" id="frmCDM" rendered="{!If(showCDM && displayAccList.size!=0,true,false)}">  
            <apex:pageBlockSection columns="1" rendered="{!IF((displayAccList.size!=0 && $Permission.INGeneric), true, false)}">                 
                <apex:pageBlockTable value="{!displayAccList}" var="cr" width="100%" rendered="{!recordType=='Person Account'}">       
                    <apex:Column headerValue="{!$ObjectType.Account.fields.LastName.Label}" rendered="{!$User.ContactId !=null}">         
                        <apex:outputLink value="/apex/AddressSelectionforExistingCustomer?id={!cr.Id}" rendered="{!$User.ContactId !=null}">{!cr.LastName}</apex:outputLink>            
                    </apex:Column>      
                    <apex:Column headerValue="{!$ObjectType.Account.fields.LastName.Label}" rendered="{!$User.ContactId ==null}">       
                        <apex:outputLink value="/{!cr.Id}" rendered="{!$User.ContactId ==null}">{!cr.LastName}</apex:outputLink>            
                    </apex:Column>      
                    <apex:Column headerValue="{!$ObjectType.Account.fields.firstName.Label}">                           
                        <apex:outputField value="{!cr.firstName}"/>     
                    </apex:Column>      
                    <apex:Column headerValue="{!$ObjectType.Account.fields.Mobile__c.Label}">                           
                        <apex:outputField value="{!cr.Mobile__c}"/>     
                    </apex:Column>      
                    <apex:Column headerValue="{!$ObjectType.Account.fields.Email__c.Label}">                            
                        <apex:outputField value="{!cr.Email__c}"/>      
                    </apex:Column>      
                    <apex:Column headerValue="{!$ObjectType.Account.fields.UCID__c.Label}">
                        <apex:outputField value="{!cr.UCID__c}"/>
                    </apex:Column>        
                </apex:pageBlockTable>     
                <apex:PageBlockTable Columns="7" value="{!displayAccList}" var="cr" width="100%" rendered="{!recordType=='Company'}">      
                    <apex:Column headerValue="{!$ObjectType.Account.fields.Name.Label}" rendered="{!$User.ContactId ==null}">       
                        <apex:outputLink value="/{!cr.Id}" rendered="{!$User.ContactId ==null}">{!cr.Name}</apex:outputLink>            
                    </apex:Column>          
                    <apex:Column headerValue="{!$ObjectType.Account.fields.Work_Phone__c.Label}">                            
                        <apex:outputField value="{!cr.Work_Phone__c}"/>      
                    </apex:Column>      
                    <apex:Column headerValue="{!$ObjectType.Account.fields.Email__c.Label}">                            
                        <apex:outputField value="{!cr.Email__c}"/>
                    </apex:Column>      
                    <apex:Column headerValue="{!$ObjectType.Account.fields.UCID__c.Label}">
                        <apex:outputField value="{!cr.UCID__c}"/>
                    </apex:Column>                      
                </apex:PageBlockTable>      
            </apex:pageBlockSection>       
            <apex:pageblockButtons >       
                <apex:commandButton value="First" action="{!first}" reRender="frmCDM" disabled="{!first}"/>       
                <apex:commandButton value="Previous" action="{!previous}" reRender="frmCDM" disabled="{!previous}"/>      
                <apex:commandButton value="Next"  disabled="{!next}" reRender="frmCDM" action="{!next}"/>     
                <apex:commandButton value="Last" disabled="{!last}" reRender="frmCDM" action="{!last}"/>      
            </apex:pageblockButtons>
        </apex:pageBlock>
        <apex:outputPanel id="mergeWarning">
            <apex:outputText style="font-weight:800" value="{!$Label.Merge_Warning_Text}" rendered="{!If(AND(OR(RecordType == 'Person Account',RecordType == 'Company'),$Permission.INGeneric) ,true,false)}"/>
        </apex:outputPanel> 
    </apex:form>
</apex:page>