<apex:page standardController="Case" extensions="GenerateAndAttachPDF" action="{!GenerateAndAttachPDF}" renderAs="pdf" applyBodyTag="false" standardStylesheets="false"> 
   <!-- Stylesheets -->
   
     <head>      
      <style type="text/css" media="print">
       body { font-family: 'Arial Unicode MS';    
       }
       @page { 
        size: A4;
                margin-top:15mm;
                margin-left:10mm;
                margin-right:10mm;
                margin-bottom:15mm;                
                padding-top: 80px;
        @top-left {
        content: element(header_left);
        }
        @bottom-right {
            content: element(footer_right);
        }      
        }    
        .header_left {
            display: block;
            text-align: left;
            position: running(header_left);
        }     
       .footer_right {
            display: block;
            padding: 5px;
            text-align: right;
            position: running(footer_right);
        }      
        .pageNumber:before {
            content: counter(page); 
        }
        
        .pageCount:before {
            content: counter(pages);  
        }
        table,tr,td {            
            border-collapse:collapse;
            }       
        table,td{    
            border: 1px solid black;  
            font-size:12px; 
           }
        table{
            width: 100%;
            font-family: Arial Unicode MS;          
           -fs-table-paginate: paginate;           
          }
          thead{display: table-header-group;}
         .Table
           {
             diaplay:table;
             margin-left:8px;
             width: 702px;
           }
            .Row
            {
              display: table-row;
            }
         .Cell
            {
              display: table-cell;
              border: solid;
              border-width: thin;
              padding-left:1px;
              border-collapse:collapse;
              font-size:12px; 
              font-family: Arial Unicode MS;              
            }                
       </style>
    </head>  
    <body style="padding-top:60px;">
    <!-- First Page Header -->
    <c:PDFHeaderFooter type="header" position="left">
         <div class="header" style="padding-top:30px;">      
          <div style="font-size:18px;border: 1px solid black;width:150px;">{!$Label.FAXCover}</div>
          <div style="font-size:25px;text-align: center;">{!$Label.CallCenterCaseInformation}</div>
          <div style="padding-top:8px;font-size:15px;text-align: right;">{!$Label.CustomerAssistanceCenter}</div>
          <div style="padding-top:3px;font-size:15px;text-align: right;">{!$Label.TelFax}</div>
          <div style="font-size:15px;text-align: left;">{!$Label.RecipientofthisFAX},<br/>{!$Label.Discardit}.</div>
        </div>
    </c:PDFHeaderFooter>
    <!-- All Pages Header -->
    <c:PDFHeaderFooter type="header" position="left">   
         <div class="header" style="padding-top:30px;">      
          <div style="font-size:18px;border: 1px solid black;width:150px;">{!$Label.FAXCover}</div>          
          <div style="font-size:25px;text-align: center;">{!$Label.CallCenterCaseInformation}</div>
          <div style="padding-top:8px;font-size:15px;text-align: right;">{!$Label.CustomerAssistanceCenter}</div>
          <div style="padding-top:3px;font-size:15px;text-align: right;">{!$Label.TelFax}</div>
          <div style="font-size:15px;text-align: left;">{!$Label.RecipientofthisFAX},<br/>{!$Label.Discardit}.</div> 
       </div>
       <div class="Table">
       <div class="Row" style="margin-left:10px;">
           <div class="Cell" style="border-bottom-style: hidden;border-right-style: hidden;width:140px;">{!$Label.Subject}</div>
           <div class="Cell" style="border-bottom-style: hidden;border-right-style: hidden;width:211px;">{!Case.Subject}</div>
           <div class="Cell" style="border-bottom-style: hidden;border-left-style: hidden;border-right-style: hidden;width:140px;"></div>
           <div class="Cell" style="border-bottom-style: hidden;border-left-style: hidden;width:211px;"></div>
       </div>
       <div class="Row" style="margin-left:10px;">
           <div class="Cell" style="border-right-style: hidden;width:140px;">{!$Label.Customer}</div>
           <div class="Cell" style="width:211px;">{!Case.Account.FirstName}&nbsp;{!Case.Account.LastName}</div>
           <div class="Cell" style="border-right-style: hidden;border-left-style: hidden;width:140px;">{!$Label.CaseNumber}</div>
           <div class="Cell" style="width:211px;">{!Case.CaseNumber}</div>
       </div>
       </div>
    </c:PDFHeaderFooter>
    <!-- All Pages Footer -->
    <c:PDFHeaderFooter type="footer" position="right" showPageNumbers="true"/> 

    <!-- Content -->     
        <div class="content" style="border: 1px solid black;padding-top:5px">         
           <div style="font-size:22px;">{!$Label.ServicePersonnel}</div>
           <div style="padding-top:5px;font-size:15px;">{!$Label.Thankyouforyourbusiness}.</div> 
           <div style="font-size:15px;">{!$Label.Customerrelatedinformation}</div>
           <div style="font-size:15px;">{!$Label.Pleasecheck}</div>
           <div style="font-size:15px;">{!$Label.Pleasetakecautiontheinformation}</div>  
        </div> 
        <br/> 
        <table cellpadding="0" cellspacing = "0" style="border-left-style: hidden;border-top-style:hidden;border-right-style: hidden;border-bottom-style:hidden;">
         <tr><td align="left" width="20%" style="border-bottom-style: hidden;border-right-style: hidden;">{!$Label.Dealer}&nbsp;</td>
             <td align="left" width="80%" colspan="3" style="border-bottom-style: hidden;">{!Case.Case_Dealer__r.Company_Name__c}&nbsp;{!Case.Case_Dealer__r.Name}
              <apex:outputlabel rendered="{!If(OR(Case.Case_Dealer__r.Company_Name__c!=Null,Case.Case_Dealer__r.Name!=Null),true,false)}">{!$Label.Onchu}</apex:outputlabel></td>
         </tr>
         <tr><td align="left" width="20%" style="border-right-style: hidden;">{!$Label.PhoneSales}&nbsp;</td>
             <td align="left" width="30%" style="border-right-style: hidden;">{!Case.Case_Dealer__r.Phone}&nbsp;</td>
             <td align="left" width="20%" style="border-right-style: hidden;">{!$Label.FAXSales}&nbsp;</td>
             <td align="left" width="30%" >{!Case.Case_Dealer__r.Fax}</td>
         </tr>
         <tr><td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.PhoneService}</td>
             <td align="left" width="30%" style="border-top-style: hidden;border-right-style: hidden;">{!Case.Case_Dealer__r.Dealer_Phone_Service__c}</td>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.FAXService}</td>
             <td align="left" width="30%" style="border-top-style: hidden;">{!Case.Case_Dealer__r.Dealer_Fax_Service__c}</td>  
         </tr>
         <tr><td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.TotalPages}</td>
             <td align="left" width="30%" style="border-top-style: hidden;border-right-style: hidden;"><span class="pageCount"/>&nbsp;{!$Label.Pages}</td>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.FAXParts}</td>
             <td align="left" width="30%" style="border-top-style: hidden;">{!Case.Case_Dealer__r.Dealer_Fax_Parts__c}</td>  
         </tr>         
      </table> 
      <br/>
      <table width="100%" cellpadding="0" cellspacing = "0" style="border-left-style: hidden;border-top-style:hidden;border-right-style: hidden;border-bottom-style:hidden;">
         <tr><td align="left" width="20%" style="border-right-style: hidden;">{!$Label.Subject}</td>
             <td align="left" colspan="3">{!Case.Subject}</td>
         </tr>
      </table>  
      <br/>
      <table width="100%" cellpadding="0" cellspacing = "0" style="border-left-style: hidden;border-top-style:hidden;border-right-style: hidden;border-bottom-style:hidden;">
          <tr>
             <td align="left" width="20%" style="border-right-style: hidden;">{!$Label.DateTime}</td>
             <td align="left" width="30%" style="border-right-style: hidden;">{!Case.CreatedDate}</td>
             <td align="left" width="20%" style="border-right-style: hidden;">{!$Label.CaseCategory}</td>
             <td align="left" width="30%">{!Case.Case_Class__c}</td>
          </tr> 
           <tr>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Kana}</td>
             <td align="left" width="30%" style="border-top-style: hidden;border-right-style: hidden;">
               <apex:outputlabel rendered="{!If(Case.Account.RecordType.Name=='Person Account',true,false)}">{!Case.Account.LastName_Native_1__c} &nbsp; {!Case.Account.FirstName_Native_1__c}</apex:outputlabel>
               <apex:outputlabel rendered="{!If(Case.Account.RecordType.Name=='Company',true,false)}">{!Case.Account.Company_Name__c}</apex:outputlabel>
             </td>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.CustomerType}</td>
             <td align="left" width="30%" style="border-top-style: hidden;">{!Case.Customer_Type__c}</td>
          </tr> 
          <tr>
             <td align="left" width="20%" rowspan="2" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Customer}</td>
             <td align="left" width="30%" rowspan="2" height="25" style="border-top-style: hidden;border-right-style: hidden;">
                <apex:outputlabel rendered="{!If(Case.Account.RecordType.Name=='Person Account',true,false)}">{!Case.Account.LastName} &nbsp; {!Case.Account.FirstName}{!$Label.Sama}</apex:outputlabel>
               <apex:outputlabel rendered="{!If(Case.Account.RecordType.Name=='Company',true,false)}">{!Case.Account.Company_Name__c} {!$Label.Sama}</apex:outputlabel>
              </td>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.UCID}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">{!Case.Account.UCID__c}</td>  
          </tr> 
          <tr>
             <td align="left" width="20%" rowspan="1" colspan="1" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.CaseNumber}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">{!Case.CaseNumber}</td>
          </tr>
          <tr>
             <td align="left" width="20%" rowspan="2" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Address}</td>
             <td align="left" width="80%" height="25" colspan="3" style="border-top-style: hidden;">
                 <apex:outputText value="{!LEFT(Case.Account.Primary_Address_Reference__r.ZipCode__c,3)}"></apex:outputText>&nbsp;-&nbsp;
                 <apex:outputText value="{!RIGHT(Case.Account.Primary_Address_Reference__r.ZipCode__c,4)}"></apex:outputText>
            </td>           
          </tr> 
           <tr>     
             <td align="left" width="80%" height="25" colspan="3" rowspan="1" style="border-top-style: hidden;">{!Case.Account.Primary_Address_Display__c}</td>           
          </tr> 
          <tr>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.SalesTEL}</td>
             <td align="left" width="30%"  height="25" style="border-top-style: hidden;border-right-style: hidden;" >{!Case.Account.Primary_Phone_Display__c}</td>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.SalesMail}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">{!Case.Account.Primary_Email_Display__c}</td>  
          </tr>
           <tr>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Phone}</td>
             <td align="left" width="30%"  height="25" style="border-top-style: hidden;border-right-style: hidden;" >{!Case.Account.Individual_Home_Phone__c}</td>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Mobile}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">{!Case.Account.Mobile__c}</td>  
          </tr> 
          <tr>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Product_ID}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!Case.Vehicle__r.UsVIN__c}</td>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.ModelRange}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">
                             {!Case.Vehicle_Class__c}&nbsp;({!case.Vehicle_Model__c})&nbsp;{!Case.Car_Remarks__c}
             </td>
          </tr>  
          <tr>
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.RegistrationNo}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!VehicleRelationshipList.Registration_Number__c}</td>
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.RegistrationDate}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">{!VehicleRelationshipList.Registration_Date__c}</td>              
          </tr> 
          <tr>
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.SellingDealer}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!VehicleRelationshipList.Selling_Dealer__r.Name}</td>  
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.ServiceDealer}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">{!VehicleRelationshipList.Last_Service_Dealer__r.Name}</td>
          </tr> 
          <tr>
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.FinanceMethod}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!VehicleRelationshipList.Finance_Method__c}</td>  
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Occupation}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">{!Case.Account.Occupation__c}</td>
          </tr> 
          <tr>
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Resource}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!Case.Data_Source__c}</td>            
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Priority}</td>
             <td align="left" width="30%" height="25" style="border-top-style: hidden;">{!Case.Priority}</td>
          </tr>
          <tr>
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.CaseType}</td>
             <td align="left" width="80%" height="25" colspan="3" style="border-top-style: hidden;">{!Case.Case_Type__c}
                <apex:outputText rendered="{!If(Case.Case_SubType__c!=Null ,true,false)}">/</apex:outputText>
                 {!Case.Case_SubType__c}
               <apex:outputText rendered="{!If(Case.Case_Situation__c!=Null ,true,false)}">/</apex:outputText>
                 {!Case.Case_Situation__c}
              </td> 
          </tr>
          <tr>
             <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;border-bottom-style:hidden;">{!$Label.Request}</td>
             <td align="left" width="80%" height="25" colspan="3" style="border-top-style: hidden;border-bottom-style: hidden;">{!Case.Case_Department__c}
                <apex:outputText rendered="{!If(Case.Customer_Request__c!=Null ,true,false)}">/</apex:outputText>
               {!Case.Customer_Request__c}</td> 
          </tr>
         </table>
         <table width="100%" cellpadding="0" cellspacing = "0"> 
          <tr>
             <td align="left" width="20%" height="25" style="border-top-style:hidden;border-bottom-style:hidden;border-left-style:hidden;">{!$Label.Share}</td>
             <td colspan="3" align="center" width="80%" style="border-top-style:hidden;border-bottom-style:hidden;border-right-style:hidden;border-left-style: hidden;">{!$Label.Informationsharing}<br/>              
              <apex:outputPanel rendered="{!If(case.Dealer_Contact__c =='Yes' ,true,false)}">
                  <img src="/img/checkbox_checked.gif"></img>
              </apex:outputPanel>
              <apex:outputPanel rendered="{!If(case.Dealer_Contact__c !='Yes' ,true,false)}">
                  <img src="/img/checkbox_unchecked.gif"></img>
              </apex:outputPanel>              
              {!$Label.Accepted}
              <apex:outputPanel rendered="{!If(case.Dealer_Contact__c =='No' ,true,false)}"> 
                  <img src="/img/checkbox_checked.gif"></img>
              </apex:outputPanel>
              <apex:outputPanel rendered="{!If(case.Dealer_Contact__c !='No' ,true,false)}">
                  <img src="/img/checkbox_unchecked.gif"></img>
              </apex:outputPanel>
             {!$Label.Couldnotexplain}
              <apex:outputPanel rendered="{!If(case.Dealer_Contact__c =='Rejected' ,true,false)}">
                  <img src="/img/checkbox_checked.gif"></img>
              </apex:outputPanel>
              <apex:outputPanel rendered="{!If(case.Dealer_Contact__c !='Rejected' ,true,false)}">
                  <img src="/img/checkbox_unchecked.gif"></img>
              </apex:outputPanel>
              {!$Label.NotAccepted}
            </td>             
        </tr>
     </table>   
      <table width="100%" cellpadding="0" cellspacing = "0" style="border-top-style: hidden;border-right-style: hidden;border-bottom-style: hidden;border-left-style: hidden;">
         <tr>
             <td align="left" width="25%" height="25" style="border-top-style: hidden;border-right-style: hidden;border-bottom-style: hidden;border-left-style: hidden;"></td>
             <td align="center" width="25%" height="25" style="border-top-style: hidden;border-left-style: hidden;border-right-style: hidden;border-bottom-style: hidden;">
             <br/><br/>
              <table width="100%" cellpadding="0" cellspacing = "0">
                <tr>
                 <td align="left" width="20%" height="25" style="border-right-style: hidden;">{!$Label.Reception}</td>
                 <td align="left" width="30%" height="25">{!case.Owner.Name}</td>
                </tr>
                <tr>
                 <td align="left" width="20%" height="25" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Copy}</td>
                 <td align="left" width="30%" height="25" style="border-top-style: hidden;"></td>
                </tr>
                <br/>
              </table>
             </td>  
          </tr>
     </table>
     <div style="page-break-after:always;"/>
     <table width="100%" cellpadding="0" cellspacing = "0" style="border-top-style:hidden;border-right-style:hidden;border-left-style:hidden;border-bottom-style:hidden;padding-top:88px;">
        <!-- <tr><td align="left" width="20%" style="border-right-style: hidden;">{!$Label.Subject}</td>
             <td align="left" colspan="3" width="80%">{!Case.Subject}</td>
         </tr>
         <tr><td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.Customer}</td>
             <td align="left" width="30%" style="border-top-style: hidden;border-right-style: hidden;">{!case.Account.FirstName}&nbsp;{!case.Account.LastName}</td>
             <td align="left" width="20%" style="border-top-style: hidden;border-right-style: hidden;">{!$Label.CaseNumber}</td>
             <td align="left" width="30%" style="border-top-style: hidden;">{!Case.CaseNumber}</td>
         </tr> -->
         <tr><td align="center" width="100%" colspan="4" style="border-top-style: hidden;">{!$Label.RequestContenttoDealer}</td></tr>
         <tr><td valign="top" align="left" width="100%" colspan="4" height="300" style="border-top-style: hidden;">
                <apex:outputText value="{!PRCommentForDealer}" style="white-space:pre;"/>  
             </td>
         </tr>
         <tr><td align="center" width="100%" colspan="4" style="border-top-style: hidden;">{!$Label.CaseContentStatus}</td></tr>
         <tr><td valign="top" align="left" width="100%" colspan="4" height="300" style="border-top-style: hidden;"><apex:outputText value="{!CustomerStatement}" style="white-space:pre;"/></td></tr> 
      </table>  
    </body>
  
</apex:page>