@isTest 
public Without Sharing class SegmentationCriteriaControllerTest 
{
Private Static List<String> filterOptions ;
 Private Static List<SelectOption> hobbyOptions ;
 Private Static List<SelectOption> leadDesiredServiceOptions ;
 Private Static  List<SelectOption> leadAdditionalServiceOptions ;
 Private Static  List<SelectOption> leadClassOptions;
 Private Static  List<SelectOption> VehicleClassOptions;
 Private Static  List<SelectOption> SpecialMarkonAccount;
 Private Static  List<SelectOption> Customerphase;
 Private Static  List<SelectOption> RetailOptOutContactReason;
 Private Static  List<SelectOption> status;
 Private Static  List<SelectOption> RetailSalesSanction;
Private Static Retail_Campaign__c rc;
Private Static  List<SelectOption> getItems;
 Private Static List<SelectOption> gender;
 Private Static List<SelectOption> personalAgreement;
 Private Static List<SelectOption> hobbies;
 Private Static List<SelectOption> idType;
 Private Static List<SelectOption> Occupation;
 Private Static List<SelectOption> province;
 Private Static List<SelectOption> nationality;
 
        Private Static Account account;
        Private Static Lead__c lead;
        Private Static Vehicle__c vehicle;
        Private Static Vehicle_Relationship__c vehicleRel;
        Private Static Campaign CampaignRec;
        Private Static Account_Link__c AlkRec;
        Private Static Retail_Task__c RatilTask;
        Private Static Address__c  address;
        Private Static campaign_member__C camMem;
        
    public static String filtername = 'Name';
 
    public static testMethod void testRetailCampaignSegmentationController()
    {
     Community_License_Switch__c cls=new Community_License_Switch__c();
        cls.Enable__c=true;
        cls.name='Community Enabled';
        insert cls;
       //Added community license switching mechanism
       if(UtilCustomSettings.getIsEnableCommunity(UtilConstant.COMMUNITY_LICENSE_SWITCH))
       {    
           User u= UtilTestData.createPortalUser('Dealer User','Dealer Community User');
           Contact con = new Contact();
            con.Title = 'Title';
            //con.Id = u.ContactId;
            con.LastName = 'LastName';
            insert con;
            //Contact con = 
            //[select Id, SegmentationFilters__c from Contact where Id = :u.ContactId];
            con.SegmentationFilters__c = '[{"name":"Filter One", "content":{"Customer":[{"field":"PersonBirthdate","operation":"Equals","criteria":"11","logic":"AND","bracket":false},{"field":"PersonEmail","operation":"Not Equals","criteria":"22","logic":"","bracket":false}],"Interest":[{"field":"Retail_Interested_Vehicle_Class__c","operation":"Greater Than","criteria":"44","logic":"AND","bracket":false},{"field":"Retail_Interested_Vehicle_Class__c","operation":"Not Equals","criteria":"33","logic":"","bracket":false}]}},{"name":"filter two", "content":{"Customer":[{"field":"FileName__c","operation":"Less Than","criteria":"11","logic":"AND","bracket":false},{"field":"Hobby__c","operation":"Not Equals","criteria":"22","logic":"","bracket":false}],"Interest":[{"field":"Lead_Source__c","operation":"Greater Than","criteria":"44","logic":"AND","bracket":false},{"field":"Lead_Type__c","operation":"Greater Than","criteria":"33","logic":"","bracket":false}],"Vehicle":[{"field":"Baumuster__c","operation":"Equals","criteria":"11","logic":"AND","bracket":true},{"field":"Baumuster__c","operation":"Not Equals","criteria":"22","logic":"AND","bracket":false},{"field":"Baumuster__c","operation":"Equals","criteria":"33","logic":"","bracket":false}]}},{"name":"Filter Three", "content":{"Customer":[{"field":"Age_Range__c","operation":"Equals","criteria":"11","logic":"AND","bracket":false},{"field":"Age_Range__c","operation":"Equals","criteria":"11","logic":"AND","bracket":false},{"field":"Age_Range__c","operation":"Equals","criteria":"11","logic":"","bracket":false}]}}]';
            update con;
            
            system.runAs(u){
                String acc3rdPartyRTId = Schema.SObjectType.Account.getRecordTypeInfosByName().get('Person Account').getRecordTypeId();
                String segmentationRTId = Schema.SObjectType.Retail_Campaign__c.getRecordTypeInfosByName().get('Segmentation Only').getRecordTypeId();
                
                Account customer = new Account(Dealer_DMS_SR_Code__c='',Status__c='xCustomer',City__c='Beijing',phone = '1344444', PersonOtherPhone='0231456987',PersonHomePhone='0231456989',PersonMobilePhone='0231456439',
                                             Retail_Fax__c='0237456989',Retail_Home_Phone__c='0281456989', Retail_Mobile__c='0231456949', Retail_Work_Phone__c='0231056989',Area_code__c = '010',Age_Range__c = '26-35',
                                            LastName = 'galaxy2', ZipCode__c='000000',Branch_name__c = '2014/06/05', File_Name__pc = 'C://User/folder',RecordTypeId=acc3rdPartyRTId);
                insert customer;
                 rc = new Retail_Campaign__c(Name = 'testCampaign',RecordTypeId=segmentationRTId ,Campaign_Execution_Channels__c ='DM' );
                insert rc;
                
                String filterString = '[{"name":"Filter One", "content":{"Customer":[{"field":"PersonBirthdate","operation":"Equals","criteria":"11","logic":"AND","bracket":false},{"field":"PersonEmail","operation":"Not Equals","criteria":"22","logic":"","bracket":false}],"Interest":[{"field":"Retail_Interested_Vehicle_Class__c","operation":"Greater Than","criteria":"44","logic":"AND","bracket":false},{"field":"Retail_Interested_Vehicle_Class__c","operation":"Not Equals","criteria":"33","logic":"","bracket":false}]}},{"name":"filter two", "content":{"Customer":[{"field":"FileName__c","operation":"Less Than","criteria":"11","logic":"AND","bracket":false},{"field":"Hobby__c","operation":"Not Equals","criteria":"22","logic":"","bracket":false}],"Interest":[{"field":"Lead_Source__c","operation":"Greater Than","criteria":"44","logic":"AND","bracket":false},{"field":"Lead_Type__c","operation":"Greater Than","criteria":"33","logic":"","bracket":false}],"Vehicle":[{"field":"Baumuster__c","operation":"Equals","criteria":"11","logic":"AND","bracket":true},{"field":"Baumuster__c","operation":"Not Equals","criteria":"22","logic":"AND","bracket":false},{"field":"Baumuster__c","operation":"Equals","criteria":"33","logic":"","bracket":false}]}},{"name":"Filter Three", "content":{"Customer":[{"field":"Age_Range__c","operation":"Equals","criteria":"11","logic":"AND","bracket":false},{"field":"Age_Range__c","operation":"Equals","criteria":"11","logic":"AND","bracket":false},{"field":"Age_Range__c","operation":"Equals","criteria":"11","logic":"","bracket":false}]}}]';
                
                PageReference retailCampaignSegmentation = Page.SegmentationCriteria_TH;
                retailCampaignSegmentation.getParameters().put('id',rc.id);
                Test.setCurrentPage(retailCampaignSegmentation);
                SegmentationCriteriaController_TH  extension = new SegmentationCriteriaController_TH();
                
                 filterOptions = extension.filterOptions;
                // hobbyOptions = extension.hobbyOptions;
                // leadDesiredServiceOptions = extension.leadDesiredServiceOptions;
               // leadAdditionalServiceOptions = extension.leadAdditionalServiceOptions;                
                //leadClassOptions=extension.leadClassOptions;
                RetailSalesSanction =extension.RetailSalesSanction;
                getItems =extension.getItems();
                VehicleClassOptions=extension.VehicleClassOptions;
                SpecialMarkonAccount = extension.SpecialMarkonAccount;
                Customerphase = extension.Customerphase;
                RetailOptOutContactReason = extension.RetailOptOutContactReason;
                status = extension.status;
                gender = extension.gender;
                personalAgreement = extension.personalAgreement;
                hobbies = extension.hobbies;
                idType = extension.idType;
                province = extension.province;
                nationality = extension.nationality;
                
                account = extension.account;
                lead = extension.lead;
                vehicle = extension.vehicle;
                vehicleRel = extension.vehicleRel;
                CampaignRec = extension.CampaignRec;
                AlkRec = extension.AlkRec;
                RatilTask = extension.RatilTask;
                address = extension.address;
                camMem = extension.camMem;
                
                Occupation = extension.Occupation;
                SegmentationCriteriaController_TH.saveFilter(filterString);
                extension.jsonFilter = '{"name":"filterName", "content":{"Customer":[{"field":"Age_Range__c","operation":"Equals","criteria":"26-35","logic":"","bracket":false}]}}';
               // extension.attendedCampaign = 'testCampaign';
                extension.searchAccount();
                //extension.addToCampaign();
                //extension.getCountries();
                //extension.first();
                // extension.last();
                // extension.previous();
                // extension.next();
                 //extension.hasnext = True;
                 //extension.hasPrevious= True;                
                //extension.leadSoql ='Select id,Retail_Campaign_Name__c from Lead__C ';
               extension.jsonFilter = '{"name":"filterName", "content":{"VehicleRelation":[{"field":"Customer_Type__c","operation":"Equals","criteria":"Demo Car","logic":"","bracket":false}]}}';
               extension.searchAccount();
               extension.jsonFilter = '{"name":"filterName", "content":{"Interest":[{"field":"CAC_Lead_Status__c","operation":"Equals","criteria":"New","logic":"","bracket":false}]}}';
               extension.searchAccount();
               extension.jsonFilter = '{"name":"filterName", "content":{"AccountLink":[{"field":"Retail_Sales_Sanction__c","operation":"Equals","criteria":"C","logic":"","bracket":false}]}}';
               extension.searchAccount();
               extension.jsonFilter = '{"name":"filterName", "content":{"Vehicle":[{"field":"FirstRegistrationDate__c","operation":"Equals","criteria":"10/18/2017","logic":"","bracket":false}]}}';
               extension.searchAccount();
               extension.jsonFilter = '{"name":"filterName", "content":{"Campaign":[{"field":"Status__c","operation":"Equals","criteria":"Bounced","logic":"","bracket":false}]}}';
               extension.searchAccount();
               extension.jsonFilter = '{"name":"filterName", "content":{"Address":[{"field":"District__c","operation":"Equals","criteria":"Hyderabad","logic":"","bracket":false}]}}';
               extension.searchAccount();
               extension.jsonFilter = '{"name":"filterName", "content":{"VehicleRetailcopy":[{"field":"NextInspectionDate__c","operation":"Equals","criteria":"10/20/2017","logic":"","bracket":false}]}}';
               extension.searchAccount();
               extension.jsonFilter = '{"name":"filterName", "content":{"VehicleRelation":[{"field":"New_Used__c","operation":"Equals","criteria":"New","logic":"","bracket":false}]}}';
               extension.searchAccount();
            try{
                SegmentationCriteriaController_TH.deleteFilter(filtername);
                }catch(Exception e){}
               // extension.getlimitAccounts();
        
            }
            
            SegmentationCriteriaController_TH  extension = new SegmentationCriteriaController_TH();
             filterOptions = extension.filterOptions;
            extension.jsonFilter = '{"name":"filterName", "content":{"Customer":[{"field":"Age_Range__c","operation":"Equals","criteria":"26-35","logic":"","bracket":false}]}}';
            extension.searchAccount();
       }
       else
       {
            Test.starttest();
            PageReference retailCampaignSegmentation = Page.SegmentationCriteria_TH;
            retailCampaignSegmentation.getParameters().put('id',rc.id);
                Test.setCurrentPage(retailCampaignSegmentation);
            SegmentationCriteriaController_TH  extension = new SegmentationCriteriaController_TH();
            extension.searchAccount();
            //extension.addToCampaign();
           // extension.getlimitAccounts();
            Test.stoptest();
           
            
       }
    }
}