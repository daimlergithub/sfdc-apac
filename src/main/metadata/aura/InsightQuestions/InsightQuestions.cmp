<aura:component controller="InsightsController" implements="force:appHostable,flexipage:availableForAllPageTypes,force:lightningQuickAction,flexipage:availableForRecordHome,lightning:actionOverride,force:hasRecordId,forceCommunity:availableForAllPageTypes" access="global">
    
    <aura:attribute name="editMode" type="Boolean" default="false" />
    <aura:attribute name="questions" type="InsightsQuestionsWrapperCls[]" />
    <aura:attribute name="SurveyType" type="String" default="Life Style" />
    <aura:attribute name="Context" type="String" default="Account" />
    <aura:attribute name="Spinner" type="boolean" default="false" />

    <aura:handler event="aura:waiting" action="{!c.showSpinner}" />
    <aura:handler event="aura:doneWaiting" action="{!c.hideSpinner}" />
    <aura:handler name="init" action="{!c.myAction}" value="{!this}" />

    <aura:if isTrue="{!v.Spinner}">
        <div aura:id="spinnerId" class="slds-spinner_container">
            <div class="slds-spinner--brand  slds-spinner slds-spinner--large slds-is-relative" role="alert">
                <span class="slds-assistive-text">Loading</span>
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
            </div>
        </div>
    </aura:if>

    <aura:if isTrue="{!v.editMode}">
        <lightning:layout horizontalAlign="left" verticalAlign="top" multipleRows="true">

            <aura:iteration items="{!v.questions}" var="lstQuestions"><br />
                <lightning:layoutItem size="12">
                    <h3 class="slds-section-title--divider"> {!lstQuestions.surveyContext}</h3>
                </lightning:layoutItem>
                <br />
                <aura:iteration items="{!lstQuestions.lstQWC}" var="question">
                    <lightning:layoutItem size="6" padding="around-medium">
                        <c:renderInput fieldlabel="{!question.questionText}" selectedAnswer="{!question.questionAnswerText}" options="{!question.lstSelectOptions}" selectedOptions="{!question.lstSelectedOptions}" fieldtype="{!question.questionType}" fieldName="{!question.QuestionId}" />
                    </lightning:layoutItem>
                </aura:iteration>
            </aura:iteration>
        </lightning:layout>
        <lightning:button variant="brand" name="Save" label="Save" title="Edit" onclick="{!c.handleClick}" />
        <lightning:button variant="brand" name="Cancel" label="Cancel" title="Cancel" onclick="{!c.handleClick}" />
        <aura:set attribute="else">
            <lightning:layout horizontalAlign="left" verticalAlign="top" multipleRows="true">
                <aura:iteration items="{!v.questions}" var="lstQuestions"><br />
                    <lightning:layoutItem size="12">
                        <h3 class="slds-section-title--divider"> {!lstQuestions.surveyContext}</h3>
                    </lightning:layoutItem>
                    <br />
                    <aura:iteration items="{!lstQuestions.lstQWC}" var="question">
                        <lightning:layoutItem size="6" padding="around-medium">
                            <lightning:formattedText padding="around-small" value="{!question.questionText}" /><br />
                            <lightning:formattedRichText padding="around-small" value="{!question.questionAnswerText}" />
                        </lightning:layoutItem>
                    </aura:iteration>
                </aura:iteration>
            </lightning:layout>
            <lightning:button variant="brand" name="Edit" label="Edit" title="Edit" onclick="{!c.handleClick}" />
        </aura:set>
    </aura:if>
</aura:component>